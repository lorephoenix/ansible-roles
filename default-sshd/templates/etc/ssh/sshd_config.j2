#
# This file is managed by Ansible.
# Do not edit this file manually.
# Any changes will be automatically reverted.
#

Port {{ sshd_port }}
AddressFamily {{ sshd_address_family }}

{% for address in sshd_listen_address %}
ListenAddress {{ address }}
{% endfor %}

# Login is allowed only for users whose primary group or
# supplementary group list matches one of the patterns
{% if sshd_allow_groups %}
AllowGroups {{ sshd_allow_groups | unique | join(" ") }}
{% endif %}

Protocol {{sshd_protocol }}

# HostKeys for protocol version 2
{% for key in sshd_host_keys %}
HostKey /etc/ssh/ssh_host_{{ key }}_key
{% endfor %}

# Specifies the available KEX (Key Exchange) algorithms.
KexAlgorithms           {{ sshd_kex_algorithms | unique | join(",") }}

# Specifies the ciphers allowed.
Ciphers                 {{ sshd_ciphers | unique | join(",") }}

# Specifies the available MAC (message authentication code) algorithms.
# The MAC algorithm is used for data integrity protection.
MACs                    {{ sshd_macs | unique | join(",") }}

#Privilege Separation is turned on for security
UsePrivilegeSeparation  {{ sshd_use_privilege_separation }}

# Logging
SyslogFacility          {{ sshd_syslog_facility }}
LogLevel                {{ sshd_log_level }}

# Authentication:
LoginGraceTime          {{ sshd_login_grace_time }}
PermitRootLogin         {{ sshd_permit_root_login }}
StrictModes             {{ sshd_strict_modes }}
MaxAuthTries            {{ sshd_max_auth_tries }}
MaxSessions             {{ sshd_max_sessions }}

PubkeyAuthentication    {{ sshd_pubkey_authentication }}

# The default is to check both .ssh/authorized_keys and .ssh/authorized_keys2
# but this is overridden so installations will only check .ssh/authorized_keys
AuthorizedKeysFile      {{ sshd_authorized_keys_file }}

# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts                                                                                                                                                                  
HostbasedAuthentication {{ sshd_host_based_authentication }}

# Change to yes if you don't trust ~/.ssh/known_hosts for                                                                                                                                                                                    
# HostbasedAuthentication                                                                                                                                                                                                                    
IgnoreUserKnownHosts    {{ sshd_ignore_user_known_hosts }}

# Don't read the user's ~/.rhosts and ~/.shosts files                                                                                                                                                                                        
IgnoreRhosts            {{ sshd_ignore_rhosts }}

# To disable tunneled clear text passwords, change to no here!                                                                                                                                                                               
PasswordAuthentication  {{ sshd_password_authentication }}
PermitEmptyPasswords    {{ sshd_permit_empty_passwords }}

# Change to no to disable s/key passwords                                                                                                                                                                                                    
ChallengeResponseAuthentication {{ sshd_challenge_response_authentication }}

# GSSAPI options                                                                                                                                                                                                                             
GSSAPIAuthentication        {{ sshd_gss_api_authentication }}
GSSAPICleanupCredentials    {{ sshd_gss_api_cleanup_credentials }}

# Set this to 'yes' to enable PAM authentication, account processing,
# and session processing. If this is enabled, PAM authentication will
# be allowed through the ChallengeResponseAuthentication and
# PasswordAuthentication.  Depending on your PAM configuration,
# PAM authentication via ChallengeResponseAuthentication may bypass
# the setting of "PermitRootLogin without-password".
# If you just want the PAM account and session checks to run without
# PAM authentication, then enable this but set PasswordAuthentication
# and ChallengeResponseAuthentication to 'no'.
# WARNING: 'UsePAM no' is not supported in Red Hat Enterprise Linux and may cause several
# problems.
UsePAM                  {{ sshd_use_pam }}

# no default banner path
Banner                  {{ sshd_banner }}

AllowAgentForwarding    {{ sshd_allow_agent_forwarding }}
AllowTcpForwarding      {{ sshd_allow_tcp_forwarding }}
ClientAliveCountMax     {{ sshd_client_alive_count_max }}
ClientAliveInterval     {{ sshd_client_alive_interval }}
Compression             {{ sshd_compression }}
GatewayPorts            {{ sshd_gateway_ports }}
MaxStartups             {{ sshd_max_startups }}
PermitTunnel            {{ sshd_permit_tunnel }}
PermitUserEnvironment   {{ sshd_permit_user_environment }}
PidFile                 {{ sshd_pid_file }}
PrintLastLog            {{ sshd_print_last_log }}
PrintMotd               {{ sshd_print_motd }}
ShowPatchLevel          {{ sshd_show_patch_level }}
TCPKeepAlive            {{ sshd_tcp_keep_alive }}
UseDNS                  {{ sshd_use_dns }}
UsePrivilegeSeparation  {{ sshd_use_privilege_separation }}
VersionAddendum         {{ sshd_version_addendum }}
X11DisplayOffset        {{ sshd_x11_display_offset }}
X11Forwarding           {{ sshd_x11_forwarding }}
X11UseLocalhost         {{ sshd_x11_use_localhost }}

# Accept locale-related environment variables
AcceptEnv               {{ sshd_accept_env }}

# override default of no subsystems
{% for sshd_subsystem in sshd_subsystems %}
Subsystem {{ sshd_subsystem.name }} {{ sshd_subsystem.path }}
{% endfor %}
